---
title: "R Notebook"
output:
  pdf_document: default
  html_notebook: default
  html_document:
    df_print: paged
---


## Estructura del objeto

```{r message=TRUE, warning=TRUE}
install.packages("dplyr")
library(NeurocienciasIntroData)
library(dplyr) # Carga dplyr y permite usar glimpse
library(tidyverse)
```


```{r eval=FALSE, include=FALSE}
library(data.table)
```

```{r}
str(neocortex.animal.size)
```

```{r}
head(neocortex.animal.size)
?neocortex.animal.size
```

```{r}
tail(neocortex.animal.size)
```

```{r}
glimpse(neocortex.animal.size)
```

```{r}
data.table::as.data.table(neocortex.animal.size)
```

## Columnas existentes

```{r}
names(neocortex.animal.size)
```

# Cambio de Factor

```{r}

soma.caracter <- as.character(neocortex.animal.size$soma_surface)
soma.numero <- as.numeric(soma.caracter)
head(soma.numero)


```

```{r}
vector.nas <- which(is.na(soma.numero)) # detecta los NA
neocortex.animal.size$soma_surface[vector.nas] # Selecciona los valores NA
```
```{r}
# Equivalente y mas conciso
soma.caracter[is.na(soma.numero)] 
```

```{r}
neocortex.animal.size[vector.nas, c("domain", "soma_surface")]
```

```{r}
neocortex.size <- neocortex.animal.size
neocortex.size$soma_surface <- as.numeric(as.character(neocortex.size$soma_surface))
neocortex.size$surface <- as.numeric(as.character(neocortex.size$surface))
```

```{r}
str(neocortex.size)
```

```{r}
mean(neocortex.size$soma_surface, na.rm = TRUE)
median(neocortex.size$soma_surface, na.rm = TRUE)
sd(neocortex.size$soma_surface, na.rm = TRUE)
```

```{r}
neocortex.size$species <- as.character(neocortex.size$species)
neocortex.size$species <- as.factor(neocortex.size$species) # esto convierte a factor

neocortex.size$species <- factor(
  neocortex.size$species,
  levels = c("elephant", "humpback whale", "rat"),
  labels = c("elefante", "ballena jorobada", "rata")
  #ordered =  # se define como TRUE o FALSE para forzar el orden con respecto al vector de levels
)

summary(neocortex.size)
```

```{r}
hist(log(neocortex.size$soma_surface))
```
```{r}
hist(neocortex.size$volume)
```

```{r}
neocortex.size$surface[1:5]

```

```{r}
log(neocortex.size$surface[1:5])
```

## Revisión del Data Set  cell type


```{r}

Data_set_cell<-cell.type.diff
?cell.type.diff
str(Data_set_cell)
```


###Preguntas de pricipal del DataSet Size: 

#### Data set cell_type:
- ¿hay variaciones entre los tipos de Datos?


###  **Convetir e num los factores de edad maxima y minima, volumen, soma surface, surface** 
```{r}
#edad máxima

maxedad.ca<- as.character(Data_set_cell$max_age)
max_Age<-as.numeric(maxedad.ca)

Data_set_cell$max_age<-as.numeric(max_Age)

#edad mínima 

minedad.ca<- as.character(Data_set_cell$min_age)
min_Age<-as.numeric(minedad.ca)
Data_set_cell$min_age<- as.numeric(min_Age, is.na=TRUE)

#volumen

vol<- as.character(Data_set_cell$volume)
volumen<-as.numeric(vol)

Data_set_cell$volume<-as.numeric(volumen)

#soma surface

som<- as.character(Data_set_cell$soma_surface)
soma_surface<-as.numeric(som)


Data_set_cell$soma_surface<-as.numeric()

#surface 

sur<- as.character(Data_set_cell$surface)
surface<-as.numeric(sur)
Data_set_cell$surface<- as.numeric(surface )


Data_set_cell$volume<-as.numeric(surface)

str(Data_set_cell)
colnames(Data_set_cell)
summary(Data_set_cell)
```

###Valores del DataSet como num en lugar de factores 

```{r}
str(Data_set_cell)

```
##Estadistica descriptiva para los datos de Volumen, edad (max y min), así como para los soma surface y surface 


### Volumen
```{r}
mean(Data_set_cell$volume, na.rm = TRUE)
sd(Data_set_cell$volume, na.rm = TRUE)
median(Data_set_cell$volume, na.rm = TRUE)
```
```{r}
ParaAplicarEstaDescrip<-dplyr::select(Data_set_cell,5,6,7,10,11)
```

### Soma surface 

```{r}
mean(Data_set_cell$soma_surface, na.rm = TRUE)
sd(Data_set_cell$soma_surface, na.rm = TRUE)
median(Data_set_cell$soma_surface, na.rm = TRUE)
```

### Min age y max age

```{r}
#min_age

mean(Data_set_cell$min_age, na.rm = TRUE)
sd(Data_set_cell$min_age,na.rm = TRUE)
median(Data_set_cell$min_age,, na.rm = TRUE)

#max_age

mean(Data_set_cell$max_age, na.rm = TRUE)
sd(Data_set_cell$max_age,na.rm = TRUE)
median(Data_set_cell$max_age,, na.rm = TRUE)


medidas<-function(x){
  c(media=mean(x,na.rm = T), 
    mediana=median(x,na.rm = T),
    desviacion_e=sd(x,na.rm = T))}

```
####usando lapply
```{r}
ParaAplicarEstaDescrip<-dplyr::select(Data_set_cell,5,6,7,10,11)

estaDescr<-function(x){
  c(media=mean(x,na.rm = T), 
    mediana=median(x,na.rm = T),
    desviacion_e=sd(x,na.rm = T))}

lapply(ParaAplicarEstaDescrip, estaDescr)
```


### Gráficas de Volumen y normalidad
```{r}
#estos datos son normales

hist(log10(Data_set_cell$volume))
shapiro.test(Data_set_cell$volume)


qqnorm(log10(Data_set_cell$volume))
qqline(log10(Data_set_cell$volume), col="red", lw=2)

```

### Soma surface gráficas y normalidad 
```{r}

str(Data_set_cell$surface)
#no podemos hacer la prueba de normalidad 

hist(log10(Data_set_cell$surface))

plot(log10(Data_set_cell$surface))

qqnorm(log10(Data_set_cell$surface))
qqline(log10(Data_set_cell$surface), col="red", lw=2)

```

###Gráficas de Soma Surface y normalidad

```{r}
str(Data_set_cell$soma_surface)
#no podemos hacer la prueba de normalidad 

hist(log10(Data_set_cell$soma_surface))

plot(log10(Data_set_cell$soma_surface))

qqnorm(log10(Data_set_cell$soma_surface))
qqline(log10(Data_set_cell$soma_surface), col="red", lw=2)

```
###Graficas de Edad (maximo y mínimo) y normalidad

```{r}
str(Data_set_cell$max_age)
str(Data_set_cell$min_age)
tail(Data_set_cell$min_age
#no podemos hacer la prueba de normalidad 
#Maxima edad
hist(Data_set_cell$max_age) 
plot(Data_set_cell$max_age)
boxplot(Data_set_cell$max_age)


#boxplots sin Outliers 
a<-IQR(Data_set_cell$max_age, na.rm=TRUE)
max_edad<-max_edad[-which(max_edad>1.5*a)]
boxplot(max_edad)

#prueba de normalidad 
shapiro.test(Data_set_cell$max_age)
qqnorm(Data_set_cell$max_age)
qqline(Data_set_cell$max_age, col="red", lw=2)

#Minima Edad

hist(Data_set_cell$min_age)
plot(Data_set_cell$min_age)
boxplot(Data_set_cell$min_age, range=1)

#Boxplor de edad mínima sin los outliers 
a<-IQR(Data_set_cell$min_age, na.rm=TRUE)
min_edad<-min_edad[-which(min_edad>1.5*a)]
boxplot(min_edad)

#Ver la normalidad de los datos
shapiro.test(Data_set_cell$min_age)
#datos muy grandes, no se puede usar shapiro 

qqnorm(Data_set_cell$min_age)
qqline(Data_set_cell$min_age, col="red", lw=2)

#debería ser normal, tiene algunos valores que están juntos a los datos, pero no lo sé 
```


## **Preguntas del DataSet de neurona principal ** 

 - ¿haciendo subgrupos necesarios de Dominio/surface/región cerebral hay diferencias 
    significa entre una rata, una ballena y un elefante- 


```{r}
?principal.cell.diff$species
Data_set_principal_<-principal.cell.diff

str(Data_set_principal)

```

# Estadísica descriptiva  de todas juntas 

```{r}
ParaAplicarEstaDescrip<-dplyr::select(Data_set_cell,5,6,7,10,11)

estaDescr<-function(x){
  c(media=mean(x,na.rm = TRUE), 
    mediana=median(x,na.rm = TRUE),
    desviacion_e=sd(x,na.rm = TRUE))}

lapply(ParaAplicarEstaDescrip, estaDescr)

Data_set_pricipal$species)


```
# división en data frames de acuerdo a la especie 

```{r}
DataSoloRatas<- Data_set_principal %>% filter(species== "rat")
str(DataSoloRatas)


DataSoloPez<- Data_set_principal %>% filter(species=="zebrafish")



#DatosSoloEle<-Data_set_pricipal %>% filter((species== "elephant"))

```
## Esta distica descriptiva a cada nuevo data frame 

Hacemos los funciónpara usar en lapply y a la vez seleccionamos lo que vamos a usar en el función 
```{r}
EstaDescrip_pez<-select(DataSoloPez,5, 6,7,10,11)
maxedad<- as.character(EstaDescrip_pez$max_age)
EstaDescrip_pez$max_age<-as.numeric(maxedad)

minedad<- as.character(EstaDescrip_pez$min_age)
EstaDescrip_pez$min_age<-as.numeric(minedad)

somaSurface<-as.character(EstaDescrip_pez$soma_surface)
EstaDescrip_pez$soma_surface<-as.numeric((somaSurface))

surface_<-as.character(EstaDescrip_pez$surface)
EstaDescrip_pez$surface<-as.numeric(surface_)

EstaDescrip_Ratas<-select(DataSoloRatas,5, 6,7,10,11)

maxedad<- as.character(EstaDescrip_Ratas$max_age)
EstaDescrip_Ratas$max_age<-as.numeric(maxedad)

minedad<- as.character(EstaDescrip_Ratas$min_age)
EstaDescrip_Ratas$min_age<-as.numeric(minedad)

somaSurface<-as.character(EstaDescrip_Ratas$soma_surface)
EstaDescrip_Ratas$soma_surface<-as.numeric((somaSurface))

surface_<-as.character(EstaDescrip_Ratas$surface)
EstaDescrip_Ratas$surface<-as.numeric(surface_)





estaDescr<-function(x){
  c(media=mean(x,na.rm = TRUE), 
    mediana=median(x,na.rm = TRUE),
    desviacion_e=sd(x,na.rm = TRUE))}
```
Aplicamos la función de lapply para obtener los valores de cada nuevo DataFrame limpiando los datos.
```{r}
lapply(EstaDescrip_Ratas, estaDescr)
lapply(EstaDescrip_pez, estaDescr)

```

#hacer las representacioens gráficas 

```{r}
plot(EstaDescrip_pez$soma_surface)
boxplot(EstaDescrip_pez$soma_surface)
hist(log10(EstaDescrip_pez$soma_surface))

plot(EstaDescrip_pez$surface)
boxplot(EstaDescrip_pez$surface)
hist(log10(EstaDescrip_pez$surface))

plot(EstaDescrip_pez$volume)
boxplot(EstaDescrip_pez$volume)

plot(EstaDescrip_pez$max_age)
boxplot(EstaDescrip_pez$max_age)
hist(EstaDescrip_pez$max_age)

plot(EstaDescrip_pez$min_age)
boxplot(EstaDescrip_pez$min_age)
hist(EstaDescrip_pez$min_age)


```
Hacemos lo mismo para los datos de Ratas 


```{r}
plot(EstaDescrip_Ratas$soma_surface)
boxplot(EstaDescrip_Ratas$soma_surface)
hist(log10(EstaDescrip_Ratas$soma_surface))

plot(EstaDescrip_Ratas$surface)
boxplot(EstaDescrip_Ratas$surface)
hist(log10(EstaDescrip_Ratas$surface))

plot(EstaDescrip_pez$volume)
boxplot(EstaDescrip_Ratas$volume)

plot(EstaDescrip_Ratas$max_age)
boxplot(EstaDescrip_Ratas$max_age)
hist(EstaDescrip_Ratas$max_age)

plot(EstaDescrip_Ratas$min_age)
boxplot(EstaDescrip_Ratas$min_age)
hist(EstaDescrip_Ratas$min_age)
```
Comprobamos la normolidad de cada columna 
- Para pez
```{r}
shapiro.test(EstaDescrip_pez$soma_surface)
shapiro.test(EstaDescrip_pez$surface)
shapiro.test(EstaDescrip_pez$volume)
shapiro.test(EstaDescrip_pez$min_age)
shapiro.test(EstaDescrip_pez$max_age)
```
- Ratas 

```{r}
shapiro.test(EstaDescrip_Ratas$soma_surface)
shapiro.test(EstaDescrip_Ratas$surface)
shapiro.test(EstaDescrip_Ratas$volume)
shapiro.test(EstaDescrip_Ratas$min_age)
shapiro.test(EstaDescrip_pez$max_age)

```
Nuestros datos so mayores a 5k por lo tanto no se puede hcen mediar la prueba de Shapiro; tenemos que usar la funcion qqplot 



Soma y soma surface y volumen 
```{r}
qqnorm(EstaDescrip_Ratas$soma_surface)
qqline(EstaDescrip_pez$soma_surface, col="red", lw=2)

qqnorm(EstaDescrip_Ratas$surface)
qqline(EstaDescrip_pez$surface, col="red", lw=2)

qqnorm(EstaDescrip_Ratas$volume)
qqline(EstaDescrip_pez$volume, col="red", lw=2)
```

Edad Maxima y mínima 
```{r}
qqnorm(EstaDescrip_Ratas$max_age)
qqline(EstaDescrip_pez$max_age, col="red", lw=2)

qqnorm(EstaDescrip_Ratas$min_age)
qqline(EstaDescrip_pez$min_age, col="red", lw=2)
```
La edad es la unica que presenta datos no normales al parecer los resultado de soma surface, surface y volumen si lo son. ¿qué significaran?

#########################33
3er DataSet de Neuronas principales
- Comparativa entre diferentes tipos de Neuronas 









